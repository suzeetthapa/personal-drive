<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Personal Drive | Your Private Cloud Storage</title>
    <meta name="theme-color" content="#4285f4">
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìÅ</text></svg>">
</head>
<body>
    <!-- Loading Screen -->
    <div id="loadingScreen" class="loading-screen">
        <div class="loading-content">
            <div class="spinner"></div>
            <h2>SuJit Drive</h2>
            <p>Loading your secure storage...</p>
        </div>
    </div>

    <!-- Auth Screen -->
    <div id="authScreen" class="screen auth-screen">
        <div class="container">
            <div class="logo-section">
                <div class="logo">
                    <i class="fas fa-cloud-upload-alt"></i>
                    <h1>SuJit Drive</h1>
                </div>
                <p class="tagline">Secure cloud storage</p>
            </div>

            <div class="setup-guide">
                <div class="setup-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>Create Repository</h3>
                        <p>Go to GitHub ‚Üí New repository ‚Üí Name it <code>my-personal-drive</code> ‚Üí Set to <strong>Private</strong></p>
                    </div>
                </div>

                <div class="setup-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>Generate Token</h3>
                        <p>GitHub Settings ‚Üí Developer settings ‚Üí Fine-grained tokens ‚Üí Generate new token</p>
                        <div class="permissions">
                            <span class="permission-badge">All repositories</span>
                            <span class="permission-badge">Contents: Read & write</span>
                            <span class="permission-badge">Metadata: Read</span>
                        </div>
                    </div>
                </div>

                <div class="setup-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>Enter Token</h3>
                        <div class="token-input">
                            <input type="password" id="githubToken" placeholder="Paste your GitHub token here" autocomplete="off">
                            <button id="showToken" class="btn-icon" title="Show token">
                                <i class="fas fa-eye"></i>
                            </button>
                        </div>
                        <button id="saveTokenBtn" class="btn-primary btn-large">
                            <i class="fas fa-lock"></i> Secure Login
                        </button>
                        <p class="note"><i class="fas fa-info-circle"></i> Token is stored locally in your browser only</p>
                    </div>
                </div>
            </div>

            <div class="features">
                <div class="feature">
                    <i class="fas fa-shield-alt"></i>
                    <h4>Secure</h4>
                    <p>End-to-end encryption</p>
                </div>
                <div class="feature">
                    <i class="fas fa-mobile-alt"></i>
                    <h4>Mobile Ready</h4>
                    <p>Works on all devices</p>
                </div>
                <div class="feature">
                    <i class="fas fa-infinity"></i>
                    <h4>Lifetime</h4>
                    <p>No expiry, no limits</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Main App -->
    <div id="appScreen" class="screen app-screen" style="display: none;">
        <!-- Top Navigation -->
        <nav class="top-nav">
            <div class="nav-left">
                <button id="menuToggle" class="btn-icon">
                    <i class="fas fa-bars"></i>
                </button>
                <div class="logo">
                    <i class="fas fa-cloud"></i>
                    <span>Personal Drive</span>
                </div>
                <div class="breadcrumb" id="breadcrumb">
                    <span class="crumb" data-path="">My Drive</span>
                </div>
            </div>

            <div class="nav-right">
                <div class="search-container">
                    <input type="text" id="searchInput" placeholder="Search files...">
                    <i class="fas fa-search"></i>
                </div>
                
                <div class="quick-actions">
                    <button id="newFolderBtn" class="btn-icon" title="New Folder">
                        <i class="fas fa-folder-plus"></i>
                    </button>
                    
                    <div class="upload-wrapper">
                        <input type="file" id="fileUpload" multiple style="display: none;">
                        <label for="fileUpload" class="btn-icon" title="Upload Files">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </label>
                    </div>
                    
                    <button id="refreshBtn" class="btn-icon" title="Refresh">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                    
                    <div class="user-menu">
                        <button id="userBtn" class="btn-icon">
                            <i class="fas fa-user-circle"></i>
                        </button>
                        <div class="user-dropdown">
                            <div class="user-info">
                                <i class="fas fa-user"></i>
                                <span id="username">User</span>
                            </div>
                            <div class="storage-usage">
                                <div class="usage-bar">
                                    <div class="usage-fill" id="usageFill"></div>
                                </div>
                                <span id="storageText">Loading...</span>
                            </div>
                            <button id="logoutBtn" class="btn-logout">
                                <i class="fas fa-sign-out-alt"></i> Logout
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Container -->
        <div class="main-container">
            <!-- Sidebar -->
            <aside class="sidebar" id="sidebar">
                <div class="sidebar-section">
                    <h3>Quick Access</h3>
                    <ul class="nav-links">
                        <li class="active" data-filter="all">
                            <i class="fas fa-th-large"></i>
                            <span>All Files</span>
                        </li>
                        <li data-filter="folders">
                            <i class="fas fa-folder"></i>
                            <span>Folders</span>
                        </li>
                        <li data-filter="images">
                            <i class="fas fa-images"></i>
                            <span>Images</span>
                        </li>
                        <li data-filter="documents">
                            <i class="fas fa-file-pdf"></i>
                            <span>Documents</span>
                        </li>
                        <li data-filter="recent">
                            <i class="fas fa-clock"></i>
                            <span>Recent</span>
                        </li>
                        <li data-filter="starred">
                            <i class="fas fa-star"></i>
                            <span>Starred</span>
                        </li>
                    </ul>
                </div>

                <div class="sidebar-section">
                    <h3>Storage</h3>
                    <div class="storage-container">
                        <div class="storage-details">
                            <div class="storage-progress">
                                <div class="progress-circle" id="progressCircle">
                                    <svg width="80" height="80">
                                        <circle cx="40" cy="40" r="36" stroke="#e0e0e0" stroke-width="4" fill="none"></circle>
                                        <circle cx="40" cy="40" r="36" stroke="#4285f4" stroke-width="4" fill="none" 
                                                stroke-dasharray="226" stroke-dashoffset="226" id="progressRing"></circle>
                                    </svg>
                                    <span id="progressPercent">0%</span>
                                </div>
                                <div class="storage-info">
                                    <h4 id="usedStorage">0 MB</h4>
                                    <p>of 1 GB used</p>
                                    <small>GitHub Free Tier</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="sidebar-section">
                    <h3>File Types</h3>
                    <div class="file-stats">
                        <div class="stat">
                            <i class="fas fa-folder" style="color: #ffb300;"></i>
                            <span id="folderCount">0</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-file" style="color: #4285f4;"></i>
                            <span id="fileCount">0</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-image" style="color: #34a853;"></i>
                            <span id="imageCount">0</span>
                        </div>
                        <div class="stat">
                            <i class="fas fa-file-pdf" style="color: #ea4335;"></i>
                            <span id="pdfCount">0</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content -->
            <main class="content-area">
                <!-- Toolbar -->
                <div class="content-toolbar">
                    <div class="selection-tools" id="selectionTools" style="display: none;">
                        <button id="cancelSelectBtn" class="btn-text">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                        <span id="selectedCount">0 selected</span>
                        <button id="downloadSelectedBtn" class="btn-primary">
                            <i class="fas fa-download"></i> Download
                        </button>
                        <button id="deleteSelectedBtn" class="btn-danger">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                        <button id="starSelectedBtn" class="btn-text">
                            <i class="fas fa-star"></i> Star
                        </button>
                    </div>

                    <div class="view-controls">
                        <div class="sort-controls">
                            <select id="sortSelect">
                                <option value="name">Name A-Z</option>
                                <option value="name_desc">Name Z-A</option>
                                <option value="date">Newest First</option>
                                <option value="date_old">Oldest First</option>
                                <option value="size">Size Large-Small</option>
                                <option value="size_small">Size Small-Large</option>
                            </select>
                        </div>
                        <div class="view-toggle">
                            <button class="view-btn active" data-view="grid">
                                <i class="fas fa-th-large"></i>
                            </button>
                            <button class="view-btn" data-view="list">
                                <i class="fas fa-list"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- File Grid/List -->
                <div class="file-container" id="fileContainer">
                    <div class="empty-state" id="emptyState">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h3>Your Drive is Empty</h3>
                        <p>Upload files or create folders to get started</p>
                        <div class="empty-actions">
                            <label for="fileUpload" class="btn-primary">
                                <i class="fas fa-cloud-upload-alt"></i> Upload Files
                            </label>
                            <button id="createFirstFolder" class="btn-secondary">
                                <i class="fas fa-folder-plus"></i> Create Folder
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Loading More -->
                <div id="loadingMore" class="loading-more" style="display: none;">
                    <div class="spinner-small"></div>
                    <span>Loading more files...</span>
                </div>
            </main>
        </div>

        <!-- Preview Modal -->
        <div id="previewModal" class="modal">
            <div class="modal-content preview-content">
                <div class="preview-header">
                    <div class="preview-info">
                        <h3 id="previewTitle"></h3>
                        <p id="previewSubtitle"></p>
                    </div>
                    <div class="preview-actions">
                        <button id="downloadPreviewBtn" class="btn-icon" title="Download">
                            <i class="fas fa-download"></i>
                        </button>
                        <button id="closePreviewBtn" class="btn-icon" title="Close">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                </div>
                <div class="preview-body" id="previewBody">
                    <!-- Preview content will be loaded here -->
                </div>
            </div>
        </div>

        <!-- New Folder Modal -->
        <div id="folderModal" class="modal">
            <div class="modal-content small-modal">
                <h3><i class="fas fa-folder-plus"></i> New Folder</h3>
                <input type="text" id="folderName" placeholder="Enter folder name" autocomplete="off">
                <div class="modal-actions">
                    <button id="createFolderBtn" class="btn-primary">Create</button>
                    <button class="btn-secondary close-modal">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Rename Modal -->
        <div id="renameModal" class="modal">
            <div class="modal-content small-modal">
                <h3><i class="fas fa-edit"></i> Rename</h3>
                <input type="text" id="renameInput" placeholder="Enter new name" autocomplete="off">
                <div class="modal-actions">
                    <button id="confirmRenameBtn" class="btn-primary">Rename</button>
                    <button class="btn-secondary close-modal">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div id="deleteModal" class="modal">
            <div class="modal-content small-modal">
                <h3><i class="fas fa-exclamation-triangle"></i> Confirm Delete</h3>
                <p id="deleteMessage">Are you sure you want to delete this item?</p>
                <div class="modal-actions">
                    <button id="confirmDeleteBtn" class="btn-danger">Delete</button>
                    <button class="btn-secondary close-modal">Cancel</button>
                </div>
            </div>
        </div>

        <!-- Toast Notification -->
        <div id="toast" class="toast">
            <span id="toastMessage"></span>
        </div>

        <!-- Upload Progress -->
        <div id="uploadProgress" class="upload-progress">
            <div class="progress-header">
                <h4>Uploading Files</h4>
                <span id="uploadClose">&times;</span>
            </div>
            <div class="progress-list" id="progressList"></div>
        </div>

        <!-- Bottom Mobile Navigation -->
        <div class="mobile-nav">
            <button class="mobile-nav-btn" data-action="upload">
                <i class="fas fa-cloud-upload-alt"></i>
                <span>Upload</span>
            </button>
            <button class="mobile-nav-btn" data-action="folder">
                <i class="fas fa-folder-plus"></i>
                <span>Folder</span>
            </button>
            <button class="mobile-nav-btn" data-action="scan">
                <i class="fas fa-camera"></i>
                <span>Scan</span>
            </button>
            <button class="mobile-nav-btn" data-action="search">
                <i class="fas fa-search"></i>
                <span>Search</span>
            </button>
            <button class="mobile-nav-btn" data-action="menu">
                <i class="fas fa-ellipsis-h"></i>
                <span>More</span>
            </button>
        </div>
    </div>

    <!-- Scripts -->
    <script src="auth.js"></script>
    <script src="app.js"></script>
    <script src="preview.js"></script>
    
    <!-- PWA Service Worker -->
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(registration => {
                    console.log('Service Worker registered');
                })
                .catch(error => {
                    console.log('Service Worker registration failed:', error);
                });
        }
    </script>
</body>
</html>